<!DOCTYPE html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Example re-captcha form</title>
<style>
#error {
  color: red;
  font-size: large;

}
</style>
<script src='https://www.google.com/recaptcha/api.js'></script>
<script type="text/javascript" charset="utf-8">
function registerAPI(form) {
  // Order off these fields is also the order in the mail 
  // Without the skiped fields in the forms.json config in the api.
  var params = {
    name: form.name.value,
    phone: form.phone.value,
    email: form.email.value,
    question: form.question.value,
    recaptcha: document.getElementById("g-recaptcha-response").value
  };

  var xhr = new XMLHttpRequest();

  // Set url for delvelopment or production
  //xhr.open("POST", "http://form-mailer-api.filmer.net/mailer/example");
  xhr.open("POST", "http://localhost:3001/mailer/example");
  xhr.onload = function() {
    var json = JSON.parse(xhr.responseText);
    console.log(json);
    if (json.submitSuccessfully) {
      showSuccess();
    } else {
      showError(json.reason);
    }
  }
  xhr.setRequestHeader("Content-type", "application/json");
  xhr.send(JSON.stringify(params));
}

function showSuccess() {
  document.getElementById("form").style.display = "none";
  document.getElementById("success").style.display = "block";
}

function showError(err) {
  document.getElementById("error").innerHTML = err;
}

</script>
</head>
<body>

<h2>Contactform</h2>
<form action="#" method="post" onsubmit="registerAPI(this);return false;" id="form" class="fancy">

  <p id="error"></p>
  
  <label for='name'>Name&nbsp;<sup>*</sup></label>
  <div class='block'><input type="text" name="name" id="name" value="" /></div>
  <div class='clear'></div>

  <label for='phone'>Phone&nbsp;<sup>*</sup></label>
  <div class='block'><input type="text" name="phone" id="phone" value="" class=" formtext"  /></div>
  <div class='clear'></div>

  <label for='email'>E-mail&nbsp;<sup>*</sup></label>
  <div class='block'><input type="text" name="email" id="email" value="" class=":required :email :only_on_submit formtext"  /></div>
  <div class='clear'></div>

  <label for='question'>Question</label>
  <div class='block'><textarea name="question" id="question" cols="24" rows="5" ></textarea></div>
  <div class='clear'></div>

  <p><sup>*</sup><span class="note"> This field is required</span></p>

  <div class="g-recaptcha" data-sitekey="6Lf7UwgTAAAAANdbikeI4WwGTYMCk_mvBF2Ze9oC"></div>

  <p><input type="submit" value="Submit"/></p>


</form>

<div id="success" style="display:none">
  Mail has been send, we will contact you soon.
</div>

</body>
</html>
